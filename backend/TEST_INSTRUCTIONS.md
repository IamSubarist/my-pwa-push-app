# Инструкция по локальному тестированию

## Быстрый тест (без зависимостей)

Самый простой способ проверить функцию нормализации ключа:

```bash
cd backend
python test_normalize_standalone.py
```

Этот тест проверяет:
- ✅ Правильный формат ключа (с переносами строк) - как вы вставили в Render
- ✅ Ключ без переносов строк (одна строка)
- ✅ Ключ с литеральными `\n` вместо реальных переносов

**Результат:** Все три формата должны быть правильно нормализованы в стандартный PEM формат.

## Полный тест (требует установки зависимостей)

Если у вас установлены все зависимости из `requirements.txt`:

```bash
cd backend
pip install -r requirements.txt
python test_key_normalization.py
```

Этот тест дополнительно проверяет:
- Загрузку ключа в `py_vapid`
- Получение публичного ключа
- Работу с реальным ключом из переменной окружения (если есть `.env` файл)

## Что проверяют тесты

1. **Нормализация ключа** - функция `normalize_vapid_private_key()` правильно обрабатывает:
   - Ключи с переносами строк (как в Render)
   - Ключи без переносов строк (одна строка)
   - Ключи с литеральными `\n`

2. **Структура PEM** - нормализованный ключ имеет правильную структуру:
   - Начинается с `-----BEGIN PRIVATE KEY-----`
   - Заканчивается на `-----END PRIVATE KEY-----`
   - Имеет правильные переносы строк
   - Содержимое разбито на строки по 64 символа

## Ожидаемый результат

Все тесты должны пройти успешно с сообщением:
```
[OK] ВСЕ ТЕСТЫ ПРОЙДЕНЫ УСПЕШНО!
```

Если тесты проходят, значит функция нормализации работает корректно и будет правильно обрабатывать ключи из Render.

